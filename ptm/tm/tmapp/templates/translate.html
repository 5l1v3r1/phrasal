<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
	<title>Translation User Interface</title>
	{% load static from staticfiles %}
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<link rel="stylesheet" href="{% static "css/font-awesome.css" %}" />
	<link rel="stylesheet" href="{% static "css/PTM.css" %}"/>
	<script type="text/javascript" src="{% static "d3.js" %}"></script>
	<script type="text/javascript" src="{% static "jquery.js" %}"></script>
	<script type="text/javascript" src="{% static "underscore.js" %}"></script>
	<script type="text/javascript" src="{% static "backbone.js" %}"></script>
	<script type="text/javascript" src="{% static "DatasetManager.js" %}"></script>
	<script type="text/javascript" src="{% static "QueryString.js" %}"></script>
	<script type="text/javascript" src="{% static "TranslateServer.js" %}"></script>
	<script type="text/javascript" src="{% static "SourceBoxState.js" %}"></script>
	<script type="text/javascript" src="{% static "SourceBoxView.js" %}"></script>
	<script type="text/javascript" src="{% static "SourceSuggestionState.js" %}"></script>
	<script type="text/javascript" src="{% static "SourceSuggestionView.js" %}"></script>
	<script type="text/javascript" src="{% static "TargetBoxState.js" %}"></script>
	<script type="text/javascript" src="{% static "TargetBoxView.js" %}"></script>
	<script type="text/javascript" src="{% static "TargetTextareaView.js" %}"></script>
	<script type="text/javascript" src="{% static "TargetOverlayView.js" %}"></script>
	<script type="text/javascript" src="{% static "TargetSuggestionState.js" %}"></script>
	<script type="text/javascript" src="{% static "TargetSuggestionView.js" %}"></script>
	<script type="text/javascript" src="{% static "OptionPanelState.js" %}"></script>
	<script type="text/javascript" src="{% static "OptionPanelView.js" %}"></script>
	<script type="text/javascript" src="{% static "DocumentView.js" %}"></script>
	<script type="text/javascript" src="{% static "PTM.js" %}"></script>
	<script type="text/javascript">
		$(document).ready( function() {
			ptm = new PTM({
				"postEditMode" : {{ conf.disable_interactive }},
				"docURL" : "{{ conf.src_document_url }}",
				"sourceLang" : "{{ conf.src_language }}",
				"targetLang" : "{{ conf.tgt_language }}"
			});
			dm = new DatasetManager();
			dm.on( "change:datasetURL", function() {
				ptm.load( dm.get( "datasetURL" ) );
			});
		});
		var prepareSubmission = function() {
			var userResponses = ptm.getUserResponses();
			var interactionLog = ptm.getInteractionLog();
			d3.select("#id_text").node().value = JSON.stringify(userResponses);
			d3.select("#id_log").node().value = JSON.stringify(interactionLog);
			return true;
		};
	</script>
</head>
<body style="padding: 0; margin: 0; background: #eee;">
<div class="UI" style="padding: 10px 20px 15px 20px; background: #888; border-bottom: 1px solid #666; box-shadow: 0 0 10px #333;">Dataset: <select id="DatasetManager"></select></div>
<div class="PAGE" style="margin: 20px 20px 200px 20px">
  <div id="PTM"></div>
  <div id="form-wrapper">
    <form action="{{ form_action }}" method="post" name="form-tgt-input" id="form-tgt-input" onsubmit="return prepareSubmission()">
      {% csrf_token %}
      {{ form.as_p }}
      <input type="submit" value="{{ form_button_text }}" name="form-tgt-submit" id="form-tgt-submit" />
    </form>
  <div>
</div>
</body>
</html>
